<!DOCTYPE html>
<html>
<head>
    <title>Générateur TP Minecraft Tinel25</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }

        .layout {
            display: flex;
            gap: 40px;
            align-items: flex-start;
        }

        form {
            flex: 1;
            max-width: 400px;
        }

        .visuals {
            display: flex;
            gap: 20px;
        }

        canvas {
            border: 1px solid #000;
            width: 500px;
            height: 500px;
            margin-top: 20px;
        }

        h1 {
            margin-bottom: 20px;
        }

        h2 {
            margin-top: 0;
        }
    </style>
</head>
<body>
    <h1>Générateur de commandes TP Minecraft Tinel25 3.0</h1>
    <div class="layout">
        <form method="post">
            <label>Liste des points (x,y,z) séparés par des retours à la ligne :</label><br>
            <textarea name="points" rows="6" cols="40">0,0,0\n10,5,3\n20,8,6</textarea><br><br>

            <label>Décalage X entre chaque point:</label><br>
            <input name="offset_x" value="0"><br><br>

            <label>Décalage Y entre chaque point:</label><br>
            <input name="offset_y" value="0"><br><br>

            <label>Décalage Z entre chaque point:</label><br>
            <input name="offset_z" value="0"><br><br>

            <label>Tag Minecraft:</label><br>
            <input name="tag" value="astsuiveur"><br><br>

            <label>Vitesse (blocs/sec):</label><br>
            <input name="speed" value="4.317"><br><br>

            <label>Tick interval:</label><br>
            <input name="tick_interval" value="2"><br><br>

            <label>Delay personnalisé (en ticks):</label><br>
            <input name="delay_ticks" value="2.8"><br><br>

            <button type="submit">Générer</button>
        </form>

        <div class="visuals">
            <div>
                <h2>Visualisation 2D (X-Z)</h2>
                <canvas id="bezierCanvas" width="500" height="500"></canvas>
            </div>
        </div>
    </div>

    <script>
        function parseCoordsList(input) {
            return input.split('\n').map(line => line.trim().split(',').map(Number));
        }

        function drawCurve2D() {
            const canvas = document.getElementById('bezierCanvas');
            const ctx = canvas.getContext('2d');
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            const points = parseCoordsList(document.querySelector('textarea[name="points"]').value);
            const offsetX = parseFloat(document.querySelector('input[name="offset_x"]').value) || 0;
            const offsetY = parseFloat(document.querySelector('input[name="offset_y"]').value) || 0;
            const offsetZ = parseFloat(document.querySelector('input[name="offset_z"]').value) || 0;

            for (let i = 0; i < points.length - 1; i++) {
                const start = points[i];
                const end = points[i + 1];
                const control = [
                    (start[0] + end[0]) / 2 + offsetX,
                    (start[1] + end[1]) / 2 + offsetY,
                    (start[2] + end[2]) / 2 + offsetZ
                ];

                const p0 = { x: start[0], y: start[2] };
                const p1 = { x: control[0], y: control[2] };
                const p2 = { x: end[0], y: end[2] };

                ctx.beginPath();
                for (let t = 0; t <= 1; t += 0.01) {
                    const x = (1 - t)**2 * p0.x + 2 * (1 - t) * t * p1.x + t**2 * p2.x;
                    const y = (1 - t)**2 * p0.y + 2 * (1 - t) * t * p1.y + t**2 * p2.y;

                    const canvasX = x + 250;
                    const canvasY = 500 - (y + 250);

                    if (t === 0) {
                        ctx.moveTo(canvasX, canvasY);
                    } else {
                        ctx.lineTo(canvasX, canvasY);
                    }
                }

                ctx.strokeStyle = "#0077cc";
                ctx.lineWidth = 2;
                ctx.stroke();
            }
        }

        document.querySelectorAll('input, textarea').forEach(el => {
            el.addEventListener('input', drawCurve2D);
        });

        window.onload = drawCurve2D;
    </script>
</body>
</html>
